# å¢å¼ºç‰ˆMDCè§„åˆ™æ–‡ä»¶å…ƒæ•°æ®æ ‡å‡†

> **ğŸ¯ ç›®æ ‡**: ä¸ºMDCè§„åˆ™æ–‡ä»¶å®šä¹‰æ ‡å‡†åŒ–çš„å…ƒæ•°æ®æ ¼å¼ï¼Œä¾¿äºAIè‡ªåŠ¨è¯†åˆ«å’Œè°ƒåº¦
> **ğŸ“‹ é€‚ç”¨èŒƒå›´**: æ‰€æœ‰.cursor/rules/ç›®å½•ä¸‹çš„è§„åˆ™æ–‡ä»¶
> **âš¡ æ ¸å¿ƒä»·å€¼**: è®©AIèƒ½å¤Ÿç²¾å‡†ç†è§£ä½•æ—¶ã€å¦‚ä½•è°ƒç”¨ç‰¹å®šè§„åˆ™æ–‡ä»¶

---

## ğŸ”§ æ ‡å‡†MDCæ–‡ä»¶å¤´éƒ¨æ ¼å¼

### åŸºç¡€æ ¼å¼æ¨¡æ¿
```yaml
---
# ===========================================
# ğŸ¤– AIè‡ªåŠ¨è°ƒåº¦é…ç½® (å¿…éœ€)
# ===========================================
ruleName: "è§„åˆ™æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†åç§°"
description: "è§„åˆ™æ–‡ä»¶çš„ç®€è¦æè¿°ï¼Œè¯´æ˜å…¶ä¸»è¦ç”¨é€”"
version: "1.0.0"
lastUpdated: "2024-01-01"

# è°ƒåº¦æ§åˆ¶
alwaysApply: false  # é»˜è®¤ä¸ºfalseï¼Œä»…æ ¸å¿ƒè§„åˆ™ä¸ºtrue
priority: 5         # 1-10ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜

# ===========================================
# ğŸ” æ™ºèƒ½æ£€æµ‹é…ç½® (æ ¸å¿ƒ)
# ===========================================
detection:
  # å…³é”®è¯æ£€æµ‹ - AIä¼šæ‰«æç”¨æˆ·è¾“å…¥ä¸­çš„è¿™äº›å…³é”®è¯
  keywords: 
    - primary: ["ä¸»è¦å…³é”®è¯1", "ä¸»è¦å…³é”®è¯2"]      # å¿…é¡»åŒ¹é…çš„å…³é”®è¯
    - secondary: ["æ¬¡è¦å…³é”®è¯1", "æ¬¡è¦å…³é”®è¯2"]    # å¯é€‰åŒ¹é…çš„å…³é”®è¯
    - technical: ["æŠ€æœ¯æœ¯è¯­1", "æŠ€æœ¯æœ¯è¯­2"]       # æŠ€æœ¯ç›¸å…³å…³é”®è¯
  
  # è·¯å¾„æ£€æµ‹ - å½“æ“ä½œè¿™äº›è·¯å¾„æ—¶è‡ªåŠ¨è§¦å‘
  paths: 
    - exact: ["precise/path/"]                    # ç²¾ç¡®è·¯å¾„åŒ¹é…
    - pattern: ["**/pattern/**", "glob/*/match"]  # æ¨¡å¼åŒ¹é…
  
  # ä¸Šä¸‹æ–‡æ£€æµ‹ - å¼€å‘åœºæ™¯å’Œæ„å›¾è¯†åˆ«
  contexts:
    - development_phase: ["å¼€å‘é˜¶æ®µ", "æµ‹è¯•é˜¶æ®µ", "éƒ¨ç½²é˜¶æ®µ"]
    - project_type: ["webå¼€å‘", "æ’ä»¶å¼€å‘", "APIå¼€å‘"]
    - user_intent: ["åŠŸèƒ½å®ç°", "é—®é¢˜è§£å†³", "æ€§èƒ½ä¼˜åŒ–"]

# ===========================================
# âš¡ è§¦å‘æ¡ä»¶é…ç½® (ç²¾ç¡®)
# ===========================================
triggers:
  # ç”¨æˆ·æ˜ç¡®æåŠ
  explicit_mentions:
    - exact_match: ["ç²¾ç¡®åŒ¹é…çš„çŸ­è¯­"]
    - fuzzy_match: ["æ¨¡ç³ŠåŒ¹é…çš„æ¦‚å¿µ"]
  
  # æ–‡ä»¶æ“ä½œè§¦å‘
  file_operations:
    - reading: ["è¯»å–ç‰¹å®šæ–‡ä»¶æ—¶è§¦å‘"]
    - editing: ["ç¼–è¾‘ç‰¹å®šæ–‡ä»¶æ—¶è§¦å‘"] 
    - creating: ["åˆ›å»ºç‰¹å®šç±»å‹æ–‡ä»¶æ—¶è§¦å‘"]
  
  # ä»£ç å†…å®¹æ£€æµ‹
  code_patterns:
    - namespaces: ["ç‰¹å®šå‘½åç©ºé—´"]
    - functions: ["ç‰¹å®šå‡½æ•°å"]
    - classes: ["ç‰¹å®šç±»å"]
    - comments: ["ç‰¹å®šæ³¨é‡Šæ¨¡å¼"]
  
  # æ„å›¾åˆ†æç»“æœ
  intent_analysis:
    - primary_intent: ["ä¸»è¦æ„å›¾ç±»å‹"]
    - secondary_intent: ["æ¬¡è¦æ„å›¾ç±»å‹"]
    - complexity_level: ["simple", "medium", "complex"]

# ===========================================
# ğŸ”— å…³è”è§„åˆ™é…ç½®
# ===========================================
relationships:
  # å¿…é¡»åŒæ—¶åŠ è½½çš„è§„åˆ™
  required_with: ["rule-file-1.mdc", "rule-file-2.mdc"]
  
  # å»ºè®®åŒæ—¶åŠ è½½çš„è§„åˆ™  
  recommended_with: ["optional-rule-1.mdc", "optional-rule-2.mdc"]
  
  # å†²çªçš„è§„åˆ™ï¼ˆä¸èƒ½åŒæ—¶åŠ è½½ï¼‰
  conflicts_with: ["conflicting-rule.mdc"]
  
  # ä¾èµ–çš„åŸºç¡€è§„åˆ™
  depends_on: ["base-rule.mdc"]

# ===========================================
# ğŸ“Š ä½¿ç”¨åœºæ™¯æè¿° (å¸®åŠ©AIç†è§£)
# ===========================================
use_cases:
  # ä¸»è¦ä½¿ç”¨åœºæ™¯
  primary:
    - scenario: "åœºæ™¯æè¿°"
      trigger_example: "ç”¨æˆ·è¾“å…¥ç¤ºä¾‹"
      expected_behavior: "é¢„æœŸAIè¡Œä¸º"
  
  # æ¬¡è¦ä½¿ç”¨åœºæ™¯  
  secondary:
    - scenario: "æ¬¡è¦åœºæ™¯æè¿°"
      trigger_example: "è§¦å‘ç¤ºä¾‹"
      expected_behavior: "é¢„æœŸè¡Œä¸º"

# ===========================================
# ğŸ¯ AIæŒ‡ä»¤é…ç½® (æ˜ç¡®æŒ‡å¯¼)
# ===========================================
ai_instructions:
  # ä½•æ—¶åº”è¯¥åŠ è½½æ­¤è§„åˆ™
  when_to_load: "æ˜ç¡®æè¿°AIåº”è¯¥åœ¨ä»€ä¹ˆæƒ…å†µä¸‹åŠ è½½æ­¤è§„åˆ™æ–‡ä»¶"
  
  # å¦‚ä½•åº”ç”¨æ­¤è§„åˆ™
  how_to_apply: "æè¿°AIåº”è¯¥å¦‚ä½•ä½¿ç”¨æ­¤è§„åˆ™æ–‡ä»¶ä¸­çš„å†…å®¹"
  
  # ä¼˜å…ˆçº§è¯´æ˜
  priority_reason: "è§£é‡Šä¸ºä»€ä¹ˆè®¾ç½®è¿™ä¸ªä¼˜å…ˆçº§"
  
  # ä¸å…¶ä»–è§„åˆ™çš„åè°ƒ
  coordination: "è¯´æ˜å¦‚ä½•ä¸å…¶ä»–è§„åˆ™åè°ƒå·¥ä½œ"

# ===========================================
# ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–é…ç½®
# ===========================================
performance:
  # é¢„åŠ è½½æ¡ä»¶
  preload_conditions: ["æ»¡è¶³ä»€ä¹ˆæ¡ä»¶æ—¶å¯ä»¥é¢„åŠ è½½"]
  
  # ç¼“å­˜ç­–ç•¥
  cache_duration: "ç¼“å­˜æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰"
  
  # å¸è½½æ¡ä»¶
  unload_conditions: ["ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥å¸è½½æ­¤è§„åˆ™"]

---
```

---

## ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: LDCMSè§„åˆ™æ–‡ä»¶çš„å¢å¼ºå…ƒæ•°æ®

```yaml
---
# ===========================================
# ğŸ¤– AIè‡ªåŠ¨è°ƒåº¦é…ç½®
# ===========================================
ruleName: "ldcms-enterprise-cms-standards"
description: "FastAdmin LDCMSä¼ä¸šç½‘ç«™ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒå¼€å‘è§„èŒƒï¼ŒåŒ…å«å¤šè¯­è¨€ã€å¤šæ¨¡æ¿æ”¯æŒ"
version: "1.4.3"
lastUpdated: "2024-12-19"

alwaysApply: false
priority: 10

# ===========================================
# ğŸ” æ™ºèƒ½æ£€æµ‹é…ç½®
# ===========================================
detection:
  keywords:
    primary: ["LDCMS", "ldcms", "ä¼ä¸šç½‘ç«™ç®¡ç†ç³»ç»Ÿ"]
    secondary: ["å¤šè¯­è¨€", "å¤šæ¨¡æ¿", "Document", "Category"]
    technical: ["addons/ldcms", "fa_ldcms_", "LanguageHandler"]
  
  paths:
    exact: ["addons/ldcms/"]
    pattern: ["**/ldcms/**", "**/LDCMS/**"]
  
  contexts:
    development_phase: ["å¼€å‘é˜¶æ®µ", "åŠŸèƒ½æ‰©å±•"]
    project_type: ["CMSå¼€å‘", "ä¼ä¸šç½‘ç«™å¼€å‘", "æ’ä»¶å¼€å‘"]
    user_intent: ["åŠŸèƒ½å®ç°", "æ¨¡å—å¼€å‘", "å†…å®¹ç®¡ç†"]

# ===========================================
# âš¡ è§¦å‘æ¡ä»¶é…ç½®
# ===========================================
triggers:
  explicit_mentions:
    exact_match: ["LDCMS", "ä¼ä¸šç½‘ç«™ç®¡ç†ç³»ç»Ÿ", "å†…å®¹ç®¡ç†ç³»ç»Ÿ"]
    fuzzy_match: ["ä¼ä¸šç½‘ç«™", "å†…å®¹ç®¡ç†", "CMSç³»ç»Ÿ"]
  
  file_operations:
    reading: ["addons/ldcms/ç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶"]
    editing: ["LDCMSç›¸å…³çš„æ§åˆ¶å™¨ã€æ¨¡å‹ã€è§†å›¾æ–‡ä»¶"]
    creating: ["æ–°çš„LDCMSåŠŸèƒ½æ¨¡å—"]
  
  code_patterns:
    namespaces: ["addons\\ldcms"]
    functions: ["getLdcmsConfig", "renderLdcmsTemplate"]
    classes: ["Document", "Category", "Langs"]
    comments: ["LDCMS", "ä¼ä¸šç½‘ç«™"]
  
  intent_analysis:
    primary_intent: ["cms_development", "plugin_development"]
    secondary_intent: ["multilanguage_setup", "template_customization"]
    complexity_level: ["medium", "complex"]

# ===========================================
# ğŸ”— å…³è”è§„åˆ™é…ç½®
# ===========================================
relationships:
  required_with: ["fastadmin-v5-standards.mdc"]
  recommended_with: ["fastadmin-multilanguage-standards.mdc", "fastadmin-multitemplate-standards.mdc"]
  depends_on: ["common-rules.mdc"]

# ===========================================
# ğŸ“Š ä½¿ç”¨åœºæ™¯æè¿°
# ===========================================
use_cases:
  primary:
    - scenario: "ç”¨æˆ·è¦ä¸ºLDCMSå¼€å‘æ–°åŠŸèƒ½"
      trigger_example: "å¸®æˆ‘ä¸ºLDCMSæ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡æ¡£ç®¡ç†æ¨¡å—"
      expected_behavior: "AIåº”è¯¥åŠ è½½LDCMSè§„èŒƒï¼Œæä¾›ç¬¦åˆLDCMSæ¶æ„çš„å¼€å‘æŒ‡å¯¼"
  
  secondary:
    - scenario: "ç”¨æˆ·è¯¢é—®LDCMSç›¸å…³é—®é¢˜"
      trigger_example: "LDCMSçš„å¤šè¯­è¨€åŠŸèƒ½æ€ä¹ˆé…ç½®ï¼Ÿ"
      expected_behavior: "AIåº”è¯¥åŸºäºLDCMSè§„èŒƒæä¾›å‡†ç¡®çš„é…ç½®æŒ‡å¯¼"

# ===========================================
# ğŸ¯ AIæŒ‡ä»¤é…ç½®
# ===========================================
ai_instructions:
  when_to_load: "å½“ç”¨æˆ·æåŠLDCMSã€ä¼ä¸šç½‘ç«™ç®¡ç†ã€æˆ–æ“ä½œaddons/ldcms/ç›®å½•æ—¶åº”ç«‹å³åŠ è½½"
  how_to_apply: "ä¸¥æ ¼æŒ‰ç…§LDCMSçš„å¼€å‘è§„èŒƒæä¾›å»ºè®®ï¼Œç¡®ä¿ä»£ç ç¬¦åˆæ’ä»¶æ¶æ„è¦æ±‚"
  priority_reason: "LDCMSæ˜¯é¡¹ç›®çš„æ ¸å¿ƒæ’ä»¶ï¼Œå…¶è§„èŒƒå¯¹æ•´ä¸ªé¡¹ç›®è‡³å…³é‡è¦"
  coordination: "ä¸FastAdminåŸºç¡€è§„èŒƒå’Œå¤šè¯­è¨€è§„èŒƒåè°ƒå·¥ä½œï¼Œé¿å…å†²çª"

# ===========================================
# ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–é…ç½®
# ===========================================
performance:
  preload_conditions: ["æ£€æµ‹åˆ°é¡¹ç›®åŒ…å«addons/ldcmsç›®å½•"]
  cache_duration: "30"
  unload_conditions: ["è¿ç»­3æ¬¡å¯¹è¯æœªæ¶‰åŠLDCMSç›¸å…³å†…å®¹"]

---
```

---

## ğŸš€ AIè°ƒåº¦æœºåˆ¶æ”¹è¿›

### å¢å¼ºçš„è°ƒåº¦ç®—æ³•
```javascript
// å¢å¼ºç‰ˆæ™ºèƒ½è§„åˆ™è°ƒåº¦ç®—æ³•
function ENHANCED_RULE_DISPATCHER(userInput, context, fileContext) {
  const relevantRules = [];
  
  // æ­¥éª¤1: æ‰«ææ‰€æœ‰è§„åˆ™æ–‡ä»¶çš„å…ƒæ•°æ®
  const allRules = scanRulesWithMetadata('.cursor/rules/');
  
  // æ­¥éª¤2: å¤šç»´åº¦åŒ¹é…åˆ†æ
  for (const rule of allRules) {
    const matchScore = calculateMatchScore(rule, userInput, context, fileContext);
    
    if (matchScore > MATCH_THRESHOLD) {
      relevantRules.push({
        rule: rule,
        score: matchScore,
        reason: getMatchReason(rule, userInput, context)
      });
    }
  }
  
  // æ­¥éª¤3: æŒ‰ä¼˜å…ˆçº§å’ŒåŒ¹é…åº¦æ’åº
  const sortedRules = relevantRules.sort((a, b) => {
    return (b.rule.priority * b.score) - (a.rule.priority * a.score);
  });
  
  // æ­¥éª¤4: å¤„ç†å…³è”è§„åˆ™
  const finalRules = processRuleRelationships(sortedRules);
  
  // æ­¥éª¤5: åº”ç”¨è§„åˆ™å¹¶æ˜¾ç¤ºè°ƒåº¦ä¿¡æ¯
  return applyRulesWithLogging(finalRules);
}

// å¤šç»´åº¦åŒ¹é…è¯„åˆ†
function calculateMatchScore(rule, userInput, context, fileContext) {
  let score = 0;
  
  // å…³é”®è¯åŒ¹é… (æƒé‡: 40%)
  score += matchKeywords(rule.detection.keywords, userInput) * 0.4;
  
  // è·¯å¾„åŒ¹é… (æƒé‡: 20%)
  score += matchPaths(rule.detection.paths, fileContext) * 0.2;
  
  // ä¸Šä¸‹æ–‡åŒ¹é… (æƒé‡: 25%)
  score += matchContexts(rule.detection.contexts, context) * 0.25;
  
  // æ„å›¾åŒ¹é… (æƒé‡: 15%)
  score += matchIntent(rule.triggers.intent_analysis, context.analyzedIntent) * 0.15;
  
  return Math.min(score, 1.0); // ç¡®ä¿åˆ†æ•°ä¸è¶…è¿‡1
}
```

---

## ğŸ“‹ å®æ–½è®¡åˆ’

### é˜¶æ®µ1: æ›´æ–°ç°æœ‰è§„åˆ™æ–‡ä»¶å…ƒæ•°æ® âœ…
ä¸ºæ‰€æœ‰ç°æœ‰è§„åˆ™æ–‡ä»¶æ·»åŠ å¢å¼ºçš„å…ƒæ•°æ®æ ¼å¼

### é˜¶æ®µ2: æµ‹è¯•è°ƒåº¦æœºåˆ¶
åˆ›å»ºæµ‹è¯•ç”¨ä¾‹éªŒè¯AIæ˜¯å¦èƒ½æ­£ç¡®è¯†åˆ«å’Œè°ƒç”¨è§„åˆ™

### é˜¶æ®µ3: ä¼˜åŒ–å’Œè°ƒæ•´
æ ¹æ®å®é™…ä½¿ç”¨æ•ˆæœè°ƒæ•´å…ƒæ•°æ®å’Œè°ƒåº¦é€»è¾‘

---

**æ€»ç»“**: é€šè¿‡å¢å¼ºMDCå…ƒæ•°æ®æ ¼å¼ï¼Œæˆ‘ä»¬å¯ä»¥è®©AIæ›´ç²¾å‡†åœ°ç†è§£ä½•æ—¶è°ƒç”¨å“ªäº›è§„åˆ™æ–‡ä»¶ï¼ŒçœŸæ­£å®ç°æ™ºèƒ½åŒ–çš„æŒ‰éœ€è°ƒåº¦ï¼