---
alwaysApply: true
priority: 11
techStack: "FastAdmin LDCMS Workflow"
contextPatterns:
  - "addons/ldcms"
  - "LDCMS"
  - "ä¼ä¸šç½‘ç«™"
  - "å¼€å‘"
  - "workflow"
---

# FastAdmin LDCMS å¼€å‘å·¥ä½œæµæ ‡å‡†è§„èŒƒ

> **ğŸ¯ æ ¸å¿ƒåŸåˆ™**: æ‰€æœ‰å¼€å‘å·¥ä½œéƒ½åŸºäºFastAdminçš„LDCMSä¼ä¸šç½‘ç«™ç®¡ç†ç³»ç»Ÿæ’ä»¶
> **ğŸ“‹ å·¥ä½œæµç¨‹**: ä¸¥æ ¼æŒ‰ç…§LDCMSæ’ä»¶çš„æ¶æ„å’Œè§„èŒƒè¿›è¡Œå¼€å‘
> **âš ï¸ å¼ºåˆ¶è¦æ±‚**: ä»»ä½•åŠŸèƒ½å¼€å‘éƒ½å¿…é¡»ä¸ç°æœ‰LDCMSæ’ä»¶å…¼å®¹

---

## ğŸš¨ LDCMSå¼€å‘å¼ºåˆ¶æ£€æŸ¥æ¸…å•

**å¼€å§‹ä»»ä½•å¼€å‘å·¥ä½œå‰ï¼Œå¿…é¡»ç¡®è®¤ä»¥ä¸‹äº‹é¡¹ï¼š**

### ğŸ“‹ é¡¹ç›®ç¯å¢ƒç¡®è®¤
- [ ] âœ… é¡¹ç›®åŸºäºFastAdminæ¡†æ¶
- [ ] âœ… å·²å®‰è£…LDCMSä¼ä¸šç½‘ç«™ç®¡ç†ç³»ç»Ÿæ’ä»¶ï¼ˆv1.4.3ï¼‰
- [ ] âœ… é¡¹ç›®åŸŸåï¼šbiubiustar.local
- [ ] âœ… åå°ç®¡ç†åœ°å€ï¼šhttp://biubiustar.local/SWTvGsCQjH.php
- [ ] âœ… æ•°æ®åº“ï¼šbiubiustarï¼Œè¡¨å‰ç¼€ï¼šfa_
- [ ] âœ… LDCMSæ’ä»¶ç›®å½•ï¼š`addons/ldcms/`
- [ ] âœ… ç°æœ‰æ¨¡æ¿ï¼šdefaultã€enã€ldcms2024ã€ldcms2025ç­‰

### ğŸ” å¼€å‘å‰åˆ†æ
- [ ] âœ… åŠŸèƒ½éœ€æ±‚æ˜¯å¦ä¸LDCMSæ’ä»¶ç›¸å…³
- [ ] âœ… æ˜¯å¦éœ€è¦å¤šè¯­è¨€æ”¯æŒï¼ˆzh-cnã€enã€zh-twï¼‰
- [ ] âœ… æ˜¯å¦éœ€è¦å¤šæ¨¡æ¿æ”¯æŒ
- [ ] âœ… æ˜¯å¦æ¶‰åŠLDCMSç°æœ‰æ•°æ®æ¨¡å‹
- [ ] âœ… æ˜¯å¦éœ€è¦APIæ¥å£æ”¯æŒ

---

## ğŸ”„ LDCMSå¼€å‘å·¥ä½œæµç¨‹

### é˜¶æ®µ1ï¼šéœ€æ±‚åˆ†æä¸è®¾è®¡
```mermaid
graph TD
    A[æ¥æ”¶å¼€å‘éœ€æ±‚] --> B{æ˜¯å¦åŸºäºLDCMS?}
    B -->|æ˜¯| C[åˆ†æLDCMSç°æœ‰åŠŸèƒ½]
    B -->|å¦| D[âŒ æ‹’ç»ï¼šå¿…é¡»åŸºäºLDCMS]
    C --> E[æ£€æŸ¥å¤šè¯­è¨€éœ€æ±‚]
    E --> F[æ£€æŸ¥å¤šæ¨¡æ¿éœ€æ±‚]
    F --> G[è®¾è®¡æ•°æ®åº“ç»“æ„]
    G --> H[è®¾è®¡APIæ¥å£]
    H --> I[å¼€å§‹å¼€å‘]
```

#### 1.1 åŠŸèƒ½éœ€æ±‚ç¡®è®¤
```php
/**
 * LDCMSåŠŸèƒ½éœ€æ±‚åˆ†ææ¨¡æ¿
 */
class LdcmsRequirementAnalysis
{
    public function analyzeRequirement($requirement)
    {
        return [
            // åŸºç¡€ä¿¡æ¯
            'project_type' => 'FastAdmin LDCMS Plugin',
            'plugin_version' => '1.4.3',
            'project_domain' => 'biubiustar.local',
            'admin_url' => 'http://biubiustar.local/SWTvGsCQjH.php',
            'frontend_url' => 'http://biubiustar.local/',
            'database' => 'biubiustar (fa_prefix)',
            'project_path' => '/Volumes/wwx/dev/WebProjects/biubiustar/',
            
            // åŠŸèƒ½åˆ†æ
            'feature_type' => $this->determineFeatureType($requirement),
            'multilang_required' => $this->checkMultiLanguageNeed($requirement),
            'multitemplate_required' => $this->checkMultiTemplateNeed($requirement),
            'api_required' => $this->checkApiNeed($requirement),
            'custom_model_required' => $this->checkCustomModelNeed($requirement),
            
            // LDCMSé›†æˆç‚¹
            'ldcms_models' => $this->getRelatedLdcmsModels($requirement),
            'ldcms_controllers' => $this->getRelatedLdcmsControllers($requirement),
            'ldcms_templates' => $this->getRelatedLdcmsTemplates($requirement),
            
            // å¼€å‘è®¡åˆ’
            'development_steps' => $this->generateDevelopmentSteps($requirement),
            'compatibility_check' => $this->checkLdcmsCompatibility($requirement)
        ];
    }
    
    private function determineFeatureType($requirement)
    {
        // ç¡®å®šåŠŸèƒ½ç±»å‹ï¼šå†…å®¹ç®¡ç†ã€ç”¨æˆ·åŠŸèƒ½ã€APIæ¥å£ã€æ¨¡æ¿å®šåˆ¶ç­‰
        if (strpos($requirement, 'å†…å®¹') !== false || strpos($requirement, 'content') !== false) {
            return 'content_management';
        }
        if (strpos($requirement, 'æ¨¡æ¿') !== false || strpos($requirement, 'template') !== false) {
            return 'template_customization';
        }
        if (strpos($requirement, 'API') !== false || strpos($requirement, 'api') !== false) {
            return 'api_development';
        }
        if (strpos($requirement, 'è¡¨å•') !== false || strpos($requirement, 'form') !== false) {
            return 'form_management';
        }
        
        return 'general_feature';
    }
    
    private function getRelatedLdcmsModels($requirement)
    {
        $models = [];
        
        // æ ¹æ®éœ€æ±‚ç¡®å®šç›¸å…³çš„LDCMSæ¨¡å‹
        if (strpos($requirement, 'æ–‡æ¡£') !== false || strpos($requirement, 'å†…å®¹') !== false) {
            $models[] = 'addons\\ldcms\\model\\Document';
        }
        if (strpos($requirement, 'åˆ†ç±»') !== false || strpos($requirement, 'category') !== false) {
            $models[] = 'addons\\ldcms\\model\\Category';
        }
        if (strpos($requirement, 'å¹¿å‘Š') !== false || strpos($requirement, 'ad') !== false) {
            $models[] = 'addons\\ldcms\\model\\Ad';
        }
        if (strpos($requirement, 'è¡¨å•') !== false || strpos($requirement, 'form') !== false) {
            $models[] = 'addons\\ldcms\\model\\Diyform';
        }
        
        return $models;
    }
}
```

### é˜¶æ®µ2ï¼šæ•°æ®åº“è®¾è®¡
```php
/**
 * LDCMSæ•°æ®åº“è®¾è®¡è§„èŒƒ
 */
class LdcmsDatabaseDesign
{
    /**
     * è®¾è®¡LDCMSå…¼å®¹çš„æ•°æ®è¡¨
     */
    public function designTable($tableName, $fields, $isMultiLang = false)
    {
        // å¼ºåˆ¶ä½¿ç”¨fa_å‰ç¼€
        if (!str_starts_with($tableName, 'fa_')) {
            $tableName = 'fa_' . $tableName;
        }
        
        // å¦‚æœä¸æ˜¯ldcmsç›¸å…³è¡¨ï¼Œå»ºè®®æ·»åŠ ldcmså‰ç¼€
        if (!str_contains($tableName, 'ldcms')) {
            $tableName = str_replace('fa_', 'fa_ldcms_', $tableName);
        }
        
        $sql = "CREATE TABLE `{$tableName}` (\n";
        $sql .= "  `id` int(11) NOT NULL AUTO_INCREMENT,\n";
        
        // æ·»åŠ è‡ªå®šä¹‰å­—æ®µ
        foreach ($fields as $field) {
            $sql .= $this->generateFieldSql($field);
        }
        
        // å¤šè¯­è¨€æ”¯æŒ
        if ($isMultiLang) {
            $sql .= "  `lang` varchar(10) NOT NULL DEFAULT 'zh-cn' COMMENT 'è¯­è¨€ä»£ç ',\n";
        }
        
        // æ ‡å‡†LDCMSå­—æ®µ
        $sql .= "  `sort` int(10) DEFAULT '99' COMMENT 'æ’åº',\n";
        $sql .= "  `status` tinyint(1) DEFAULT '1' COMMENT 'çŠ¶æ€',\n";
        $sql .= "  `create_time` bigint(20) DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',\n";
        $sql .= "  `update_time` bigint(20) DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',\n";
        $sql .= "  PRIMARY KEY (`id`),\n";
        
        // å¤šè¯­è¨€ç´¢å¼•
        if ($isMultiLang) {
            $sql .= "  KEY `lang` (`lang`),\n";
        }
        
        $sql .= "  KEY `status` (`status`),\n";
        $sql .= "  KEY `sort` (`sort`)\n";
        $sql .= ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='{$tableName}è¡¨';\n";
        
        return $sql;
    }
    
    /**
     * æ£€æŸ¥ä¸ç°æœ‰LDCMSè¡¨çš„å…¼å®¹æ€§
     */
    public function checkCompatibility($newTable)
    {
        $ldcmsTables = [
            'fa_ldcms_document',
            'fa_ldcms_category', 
            'fa_ldcms_ad',
            'fa_ldcms_langs',
            'fa_ldcms_tags',
            'fa_ldcms_models',
            'fa_ldcms_fields',
            'fa_ldcms_diyform',
            'fa_ldcms_diyform_data',
            'fa_ldcms_diyform_fields',
            'fa_ldcms_links'
        ];
        
        // æ£€æŸ¥æ˜¯å¦ä¸ç°æœ‰è¡¨å†²çª
        // æ£€æŸ¥å¤–é”®å…³ç³»
        // æ£€æŸ¥å­—æ®µå‘½åè§„èŒƒ
        
        return [
            'compatible' => true,
            'warnings' => [],
            'suggestions' => []
        ];
    }
}
```

### é˜¶æ®µ3ï¼šæ¨¡å‹å¼€å‘
```php
/**
 * LDCMSæ¨¡å‹å¼€å‘è§„èŒƒ
 */
class LdcmsModelDevelopment
{
    /**
     * åˆ›å»ºLDCMSå…¼å®¹çš„æ¨¡å‹ç±»
     */
    public function createModel($modelName, $tableName, $features = [])
    {
        $namespace = 'addons\\ldcms\\model';
        $extends = 'MultiLangModel'; // å¦‚æœæ”¯æŒå¤šè¯­è¨€
        
        if (!in_array('multilang', $features)) {
            $extends = '\\think\\Model';
        }
        
        $modelCode = "<?php\n\n";
        $modelCode .= "namespace {$namespace};\n\n";
        $modelCode .= "use think\\Model;\n";
        
        if (in_array('multilang', $features)) {
            $modelCode .= "use addons\\ldcms\\model\\MultiLangModel;\n";
        }
        
        $modelCode .= "\n/**\n";
        $modelCode .= " * {$modelName}æ¨¡å‹\n";
        $modelCode .= " * åŸºäºLDCMSæ’ä»¶æ¶æ„å¼€å‘\n";
        $modelCode .= " */\n";
        $modelCode .= "class {$modelName} extends {$extends}\n";
        $modelCode .= "{\n";
        $modelCode .= "    protected \$name = '{$tableName}';\n";
        $modelCode .= "    \n";
        $modelCode .= "    // è‡ªåŠ¨å†™å…¥æ—¶é—´æˆ³\n";
        $modelCode .= "    protected \$autoWriteTimestamp = 'int';\n";
        $modelCode .= "    protected \$createTime = 'create_time';\n";
        $modelCode .= "    protected \$updateTime = 'update_time';\n";
        $modelCode .= "    \n";
        
        // å¤šè¯­è¨€æ”¯æŒ
        if (in_array('multilang', $features)) {
            $modelCode .= "    // å¤šè¯­è¨€æ¨¡å¼\n";
            $modelCode .= "    protected \$langMode = 'relation';\n";
            $modelCode .= "    \n";
            $modelCode .= "    /**\n";
            $modelCode .= "     * è·å–å½“å‰è¯­è¨€æ•°æ®\n";
            $modelCode .= "     */\n";
            $modelCode .= "    public function scopeLang(\$query, \$lang = '')\n";
            $modelCode .= "    {\n";
            $modelCode .= "        \$lang = \$lang ?: \\addons\\ldcms\\utils\\LanguageHandler::getCurrentLanguage();\n";
            $modelCode .= "        return \$query->where('lang', \$lang);\n";
            $modelCode .= "    }\n";
            $modelCode .= "    \n";
        }
        
        // çŠ¶æ€æŸ¥è¯¢
        $modelCode .= "    /**\n";
        $modelCode .= "     * è·å–å¯ç”¨çŠ¶æ€çš„æ•°æ®\n";
        $modelCode .= "     */\n";
        $modelCode .= "    public function scopeEnabled(\$query)\n";
        $modelCode .= "    {\n";
        $modelCode .= "        return \$query->where('status', 1);\n";
        $modelCode .= "    }\n";
        $modelCode .= "    \n";
        
        // æ’åºæŸ¥è¯¢
        $modelCode .= "    /**\n";
        $modelCode .= "     * æŒ‰æ’åºå­—æ®µæ’åº\n";
        $modelCode .= "     */\n";
        $modelCode .= "    public function scopeOrdered(\$query)\n";
        $modelCode .= "    {\n";
        $modelCode .= "        return \$query->order('sort asc, id desc');\n";
        $modelCode .= "    }\n";
        
        $modelCode .= "}\n";
        
        return $modelCode;
    }
}
```

### é˜¶æ®µ4ï¼šæ§åˆ¶å™¨å¼€å‘
```php
/**
 * LDCMSæ§åˆ¶å™¨å¼€å‘è§„èŒƒ
 */
class LdcmsControllerDevelopment
{
    /**
     * åˆ›å»ºLDCMSå…¼å®¹çš„æ§åˆ¶å™¨
     */
    public function createController($controllerName, $features = [])
    {
        $namespace = 'addons\\ldcms\\controller';
        
        $controllerCode = "<?php\n\n";
        $controllerCode .= "namespace {$namespace};\n\n";
        $controllerCode .= "use addons\\ldcms\\controller\\Base;\n";
        $controllerCode .= "use addons\\ldcms\\utils\\LanguageHandler;\n";
        $controllerCode .= "use think\\Request;\n";
        $controllerCode .= "use think\\Response;\n\n";
        $controllerCode .= "/**\n";
        $controllerCode .= " * {$controllerName}æ§åˆ¶å™¨\n";
        $controllerCode .= " * åŸºäºLDCMSæ’ä»¶æ¶æ„å¼€å‘\n";
        $controllerCode .= " */\n";
        $controllerCode .= "class {$controllerName} extends Base\n";
        $controllerCode .= "{\n";
        $controllerCode .= "    /**\n";
        $controllerCode .= "     * åˆå§‹åŒ–\n";
        $controllerCode .= "     */\n";
        $controllerCode .= "    protected function initialize()\n";
        $controllerCode .= "    {\n";
        $controllerCode .= "        parent::initialize();\n";
        $controllerCode .= "        \n";
        $controllerCode .= "        // LDCMSåˆå§‹åŒ–é€»è¾‘\n";
        $controllerCode .= "        \$this->initLdcmsEnvironment();\n";
        $controllerCode .= "    }\n";
        $controllerCode .= "    \n";
        $controllerCode .= "    /**\n";
        $controllerCode .= "     * åˆå§‹åŒ–LDCMSç¯å¢ƒ\n";
        $controllerCode .= "     */\n";
        $controllerCode .= "    private function initLdcmsEnvironment()\n";
        $controllerCode .= "    {\n";
        $controllerCode .= "        // è®¾ç½®å½“å‰è¯­è¨€\n";
        $controllerCode .= "        \$this->lang = LanguageHandler::getCurrentLanguage();\n";
        $controllerCode .= "        \n";
        $controllerCode .= "        // è®¾ç½®æ¨¡æ¿å˜é‡\n";
        $controllerCode .= "        \$this->assign([\n";
        $controllerCode .= "            'lang' => \$this->lang,\n";
        $controllerCode .= "            'site' => \$this->getSiteConfig(),\n";
        $controllerCode .= "            'seo' => \$this->getSeoConfig()\n";
        $controllerCode .= "        ]);\n";
        $controllerCode .= "    }\n";
        $controllerCode .= "    \n";
        $controllerCode .= "    /**\n";
        $controllerCode .= "     * é¦–é¡µ\n";
        $controllerCode .= "     */\n";
        $controllerCode .= "    public function index()\n";
        $controllerCode .= "    {\n";
        $controllerCode .= "        // LDCMSæ ‡å‡†é¡µé¢æ¸²æŸ“\n";
        $controllerCode .= "        return \$this->renderLdcmsTemplate('index');\n";
        $controllerCode .= "    }\n";
        $controllerCode .= "}\n";
        
        return $controllerCode;
    }
}
```

### é˜¶æ®µ5ï¼šæ¨¡æ¿å¼€å‘
```php
/**
 * LDCMSæ¨¡æ¿å¼€å‘è§„èŒƒ
 */
class LdcmsTemplateDevelopment
{
    /**
     * åˆ›å»ºLDCMSå…¼å®¹çš„æ¨¡æ¿æ–‡ä»¶
     */
    public function createTemplate($templateName, $templateType = 'page')
    {
        $templateCode = "<!DOCTYPE html>\n";
        $templateCode .= "<html lang=\"{\$lang}\">\n";
        $templateCode .= "<head>\n";
        $templateCode .= "    <meta charset=\"utf-8\">\n";
        $templateCode .= "    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n";
        $templateCode .= "    <title>{\$seo.title}</title>\n";
        $templateCode .= "    <meta name=\"keywords\" content=\"{\$seo.keywords}\">\n";
        $templateCode .= "    <meta name=\"description\" content=\"{\$seo.description}\">\n";
        $templateCode .= "</head>\n";
        $templateCode .= "<body>\n";
        $templateCode .= "    <!-- LDCMSæ¨¡æ¿ï¼š{$templateName} -->\n";
        $templateCode .= "    \n";
        
        switch ($templateType) {
            case 'list':
                $templateCode .= $this->generateListTemplate();
                break;
            case 'detail':
                $templateCode .= $this->generateDetailTemplate();
                break;
            case 'form':
                $templateCode .= $this->generateFormTemplate();
                break;
            default:
                $templateCode .= $this->generatePageTemplate();
        }
        
        $templateCode .= "    \n";
        $templateCode .= "</body>\n";
        $templateCode .= "</html>\n";
        
        return $templateCode;
    }
    
    private function generateListTemplate()
    {
        return "    <!-- åˆ†ç±»åˆ—è¡¨ -->\n" .
               "    {ldcms:document cid=\"{\$category.id}\" limit=\"10\"}\n" .
               "    <div class=\"document-list\">\n" .
               "        <h2>{\$document.title}</h2>\n" .
               "        <p>{\$document.description}</p>\n" .
               "        <a href=\"{\$document.url}\">é˜…è¯»æ›´å¤š</a>\n" .
               "    </div>\n" .
               "    {/ldcms:document}\n";
    }
    
    private function generateDetailTemplate()
    {
        return "    <!-- æ–‡æ¡£è¯¦æƒ… -->\n" .
               "    <article class=\"document-detail\">\n" .
               "        <h1>{\$document.title}</h1>\n" .
               "        <div class=\"meta\">\n" .
               "            <span>å‘å¸ƒæ—¶é—´ï¼š{\$document.create_time|date='Y-m-d'}</span>\n" .
               "            <span>æµè§ˆæ¬¡æ•°ï¼š{\$document.views}</span>\n" .
               "        </div>\n" .
               "        <div class=\"content\">\n" .
               "            {\$document.content|raw}\n" .
               "        </div>\n" .
               "    </article>\n";
    }
}
```

---

## ğŸ“‹ LDCMSå¼€å‘æ£€æŸ¥æ¸…å•

### å¼€å‘å‰æ£€æŸ¥
- [ ] ç¡®è®¤åŸºäºLDCMSæ’ä»¶å¼€å‘
- [ ] æ£€æŸ¥å¤šè¯­è¨€éœ€æ±‚
- [ ] æ£€æŸ¥å¤šæ¨¡æ¿éœ€æ±‚
- [ ] ç¡®è®¤æ•°æ®åº“è®¾è®¡ç¬¦åˆLDCMSè§„èŒƒ
- [ ] ç¡®è®¤APIæ¥å£è®¾è®¡

### å¼€å‘ä¸­æ£€æŸ¥
- [ ] ä½¿ç”¨LDCMSå‘½åç©ºé—´
- [ ] ç»§æ‰¿LDCMSåŸºç±»
- [ ] ä½¿ç”¨LDCMSå·¥å…·ç±»
- [ ] éµå¾ªLDCMSæ•°æ®ç»“æ„
- [ ] ä½¿ç”¨LDCMSæ¨¡æ¿æ ‡ç­¾

### å¼€å‘åæ£€æŸ¥
- [ ] å…¼å®¹æ€§æµ‹è¯•
- [ ] å¤šè¯­è¨€åŠŸèƒ½æµ‹è¯•
- [ ] å¤šæ¨¡æ¿åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] å®‰å…¨æ€§æµ‹è¯•

### éƒ¨ç½²å‰æ£€æŸ¥
- [ ] ä»£ç è§„èŒƒæ£€æŸ¥
- [ ] åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥
- [ ] æ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥
- [ ] æµ‹è¯•ç”¨ä¾‹è¦†ç›–
- [ ] å¤‡ä»½ç°æœ‰æ•°æ®

---

**æ³¨æ„**: ä¸¥æ ¼æŒ‰ç…§æ­¤å·¥ä½œæµè¿›è¡Œå¼€å‘ï¼Œç¡®ä¿æ‰€æœ‰åŠŸèƒ½éƒ½ä¸LDCMSæ’ä»¶å®Œç¾é›†æˆï¼