# FastAdmin LDCMS 企业网站管理系统开发标准规范

> **基于FastAdmin + ThinkPHP + Uniapp的企业网站管理系统**
> **版本要求**: LDCMS >= 1.2.0, ThinkPHP 5.1, FastAdmin基础框架

---

## 🎯 核心架构理解

### 📁 LDCMS目录结构标准
```
addons/ldcms/
├── view/              # 前台模板目录
│   ├── default/       # 默认中文模板
│   ├── en/           # 英文模板
│   ├── biubiustar2025zh-cn/  # 自定义模板组
│   └── [custom]/     # 其他自定义模板
├── controller/       # 控制器
├── model/           # 数据模型
├── validate/        # 验证器
├── library/         # 类库文件
└── utils/          # 工具类
```

### 🗄️ LDCMS核心数据表
| 表名 | 作用 | 重要性 |
|------|------|--------|
| `fa_ldcms_langs` | **多语言配置表** - 模板管理核心 | ⭐⭐⭐⭐⭐ |
| `fa_ldcms_category` | 栏目分类表 | ⭐⭐⭐⭐⭐ |
| `fa_ldcms_document` | 文档内容表 | ⭐⭐⭐⭐⭐ |
| `fa_ldcms_ad` | 广告/轮播图表 | ⭐⭐⭐⭐ |
| `fa_ldcms_siteinfo` | 站点信息表 | ⭐⭐⭐⭐ |

---

## 🎨 模板系统核心规范

### 模板管理机制
- **不依赖额外主题表**: LDCMS模板管理完全基于`fa_ldcms_langs`表和文件系统扫描
- **模板发现机制**: 通过`ThemeService::getThemeList()`扫描`addons/ldcms/view/`目录
- **语言模板映射**: 每个语言记录的`template`字段指定对应模板目录

### 静态资源引入规范
```html
<!-- 推荐方式：{ld:src}标签 (LDCMS专用) -->
{ld:src src="css/style.css"}
{ld:src src="js/app.js"}

<!-- 兼容方式：__ADDON__替换 -->
<link rel="stylesheet" href="__ADDON__/css/style.css">

<!-- 静态资源位置 -->
public/assets/addons/ldcms/template-name/
```

---

## 🏷️ LDCMS标签系统规范

### 核心标签使用

#### 1. 导航标签
```html
{ld:nav}
<li class="{if $item['id']==$topid}active{/if}">
    <a href="{$item.url}">{$item.name}</a>
</li>
{/ld:nav}
```

#### 2. 轮播图标签
```html
{ld:slide name="banner"}
<div class="slide-item">
    <a href="{$item.url}" target="{$item.target}">
        <img src="{$item.image}" alt="{$item.title}" />
    </a>
</div>
{/ld:slide}
```

#### 3. 内容列表标签
```html
{ld:list cid="$category.id" limit="10"}
<article class="news-item">
    <h3><a href="{$item.url}">{$item.title}</a></h3>
    <div class="meta">
        <span class="date">{$item.show_time|ld_fdate='Y-m-d'}</span>
    </div>
</article>
{/ld:list}
```

---

## 💾 数据模型开发规范

### Category模型字段访问
```php
// Category模型必需字段
protected $append = [
    'url',
    'ename'  // 必须包含，用于模板显示
];

// 字段访问器
public function getEnameAttr($value, $data)
{
    return isset($data['ename']) && !empty($data['ename']) 
        ? $data['ename'] 
        : $data['name'];
}
```

### Document模型字段访问
```php
// Document模型必需字段
protected $append = [
    'url',
    'seo_description',
    'description',
    'curl',
    'price'  // 产品模型常用字段
];
```

---

## 🌐 多语言支持规范

### 语言配置标准
```sql
-- fa_ldcms_langs表必需字段
INSERT INTO fa_ldcms_langs VALUES
(1, 'zh-cn', '简体中文', 'biubiustar2025zh-cn', 1, 1, 1),
(2, 'en', 'English', 'biubiustar2025en', 0, 1, 2);
```

---

## ⚠️ 常见问题处理

### 模板无法访问问题排查
1. **检查fa_ldcms_langs表配置**
   - 验证language code不为空
   - 确认template字段指向正确模板目录
   - 检查is_default和status字段

2. **检查模型字段访问**
   - Category模型必须包含ename字段访问器
   - Document模型必须包含price等业务字段
   - 确保所有append字段都有对应访问器

3. **检查静态资源**
   - 验证public/assets/addons/ldcms/目录结构
   - 确认模板使用{ld:src}标签引用资源

---

**注意**: 本规范基于LDCMS v1.2+版本，请根据实际使用的版本调整相关配置。
