---
alwaysApply: true
priority: 4
techStack: "FastAdmin Plugin System"
---

# FastAdmin æ’ä»¶å¼€å‘æ ‡å‡†è§„èŒƒ

> **åŠŸèƒ½**: FastAdminæ’ä»¶ç³»ç»Ÿå¼€å‘è§„èŒƒ
> **é€‚ç”¨åœºæ™¯**: æ’ä»¶å¼€å‘ã€åŠŸèƒ½æ‰©å±•ã€æ¨¡å—åŒ–å¼€å‘

---

## ğŸš€ æ’ä»¶ç³»ç»Ÿæ¶æ„

### æ’ä»¶ç›®å½•ç»“æ„
```
addons/
â”œâ”€â”€ example/                    # æ’ä»¶ç›®å½•ï¼ˆæ’ä»¶æ ‡è¯†åï¼‰
â”‚   â”œâ”€â”€ config/                # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”‚   â””â”€â”€ config.php         # æ’ä»¶é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ controller/            # æ§åˆ¶å™¨ç›®å½•
â”‚   â”‚   â”œâ”€â”€ Index.php          # å‰å°æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ Admin.php          # åå°æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ model/                 # æ¨¡å‹ç›®å½•
â”‚   â”‚   â””â”€â”€ Example.php        # æ¨¡å‹æ–‡ä»¶
â”‚   â”œâ”€â”€ view/                  # è§†å›¾ç›®å½•
â”‚   â”‚   â”œâ”€â”€ index/             # å‰å°è§†å›¾
â”‚   â”‚   â””â”€â”€ admin/             # åå°è§†å›¾
â”‚   â”œâ”€â”€ lang/                  # è¯­è¨€åŒ…ç›®å½•
â”‚   â”‚   â””â”€â”€ zh-cn.php          # ä¸­æ–‡è¯­è¨€åŒ…
â”‚   â”œâ”€â”€ public/                # é™æ€èµ„æºç›®å½•
â”‚   â”‚   â”œâ”€â”€ assets/            # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ css/           # CSSæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ js/            # JavaScriptæ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ img/           # å›¾ç‰‡æ–‡ä»¶
â”‚   â”œâ”€â”€ install.sql            # å®‰è£…SQLæ–‡ä»¶
â”‚   â”œâ”€â”€ uninstall.sql          # å¸è½½SQLæ–‡ä»¶
â”‚   â”œâ”€â”€ info.ini               # æ’ä»¶ä¿¡æ¯æ–‡ä»¶
â”‚   â”œâ”€â”€ Example.php            # æ’ä»¶ä¸»ç±»
â”‚   â””â”€â”€ LICENSE                # è®¸å¯è¯æ–‡ä»¶
```

---

## ğŸ“ æ’ä»¶ä¿¡æ¯é…ç½®

### info.ini é…ç½®æ–‡ä»¶
```ini
[addon]
name = example
title = ç¤ºä¾‹æ’ä»¶
intro = è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ’ä»¶ï¼Œç”¨äºæ¼”ç¤ºæ’ä»¶å¼€å‘è§„èŒƒ
author = FastAdmin
website = https://www.fastadmin.net
version = 1.0.0
state = 1
url = /addons/example
license = MIT
tags = example,demo
has_adminlist = 1
```

### é…ç½®å‚æ•°è¯´æ˜
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `name` | string | âœ“ | æ’ä»¶æ ‡è¯†åï¼Œå¿…é¡»ä¸ç›®å½•åä¸€è‡´ |
| `title` | string | âœ“ | æ’ä»¶æ ‡é¢˜ |
| `intro` | string | âœ“ | æ’ä»¶ç®€ä»‹ |
| `author` | string | âœ“ | æ’ä»¶ä½œè€… |
| `website` | string | âœ— | æ’ä»¶å®˜ç½‘ |
| `version` | string | âœ“ | æ’ä»¶ç‰ˆæœ¬å· |
| `state` | int | âœ— | æ’ä»¶çŠ¶æ€ï¼ˆ1å¯ç”¨ï¼Œ0ç¦ç”¨ï¼‰ |
| `url` | string | âœ— | æ’ä»¶è®¿é—®URL |
| `license` | string | âœ— | è®¸å¯è¯ç±»å‹ |
| `tags` | string | âœ— | æ’ä»¶æ ‡ç­¾ï¼Œé€—å·åˆ†éš” |
| `has_adminlist` | int | âœ— | æ˜¯å¦æœ‰åå°ç®¡ç†é¡µé¢ |

---

## ğŸ¯ æ’ä»¶ä¸»ç±»å¼€å‘

### æ’ä»¶ä¸»ç±»ç»“æ„
```php
<?php
namespace addons\example;

use think\Addons;

/**
 * ç¤ºä¾‹æ’ä»¶
 */
class Example extends Addons
{
    /**
     * æ’ä»¶å®ä¾‹
     */
    public $info = [
        'name'        => 'example',
        'title'       => 'ç¤ºä¾‹æ’ä»¶',
        'description' => 'è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ’ä»¶',
        'status'      => 1,
        'author'      => 'FastAdmin',
        'version'     => '1.0.0'
    ];

    /**
     * æ’ä»¶å®‰è£…æ–¹æ³•
     * @return bool
     */
    public function install()
    {
        $menu = [
            [
                'name'    => 'example',
                'title'   => 'ç¤ºä¾‹æ’ä»¶',
                'sublist' => [
                    [
                        'name'  => 'example/index',
                        'title' => 'æ’ä»¶é¦–é¡µ'
                    ],
                    [
                        'name'  => 'example/config', 
                        'title' => 'æ’ä»¶é…ç½®'
                    ]
                ]
            ]
        ];
        return $this->addMenus($menu);
    }

    /**
     * æ’ä»¶å¸è½½æ–¹æ³•
     * @return bool
     */
    public function uninstall()
    {
        $menu = [
            'example'
        ];
        return $this->deleteMenus($menu);
    }

    /**
     * æ’ä»¶å¯ç”¨æ–¹æ³•
     * @return bool
     */
    public function enable()
    {
        $menu = [
            'example'
        ];
        return $this->enableMenus($menu);
    }

    /**
     * æ’ä»¶ç¦ç”¨æ–¹æ³•
     * @return bool
     */
    public function disable()
    {
        $menu = [
            'example'
        ];
        return $this->disableMenus($menu);
    }

    /**
     * è·å–æ’ä»¶é…ç½®
     */
    public function getConfig($name = '')
    {
        $config = get_addon_config('example');
        if ($name != '') {
            return isset($config[$name]) ? $config[$name] : '';
        }
        return $config;
    }

    /**
     * è®¾ç½®æ’ä»¶é…ç½®
     */
    public function setConfig($name, $value = '')
    {
        $config = get_addon_config('example');
        if (is_array($name)) {
            $config = array_merge($config, $name);
        } else {
            $config[$name] = $value;
        }
        return set_addon_config('example', $config);
    }
}
```

### æ’ä»¶é’©å­æ–¹æ³•
```php
/**
 * åº”ç”¨åˆå§‹åŒ–é’©å­
 */
public function appInit()
{
    // åœ¨åº”ç”¨åˆå§‹åŒ–æ—¶æ‰§è¡Œçš„ä»£ç 
}

/**
 * åº”ç”¨å¼€å§‹é’©å­
 */
public function appBegin()
{
    // åœ¨åº”ç”¨å¼€å§‹æ—¶æ‰§è¡Œçš„ä»£ç 
}

/**
 * æ¨¡å—åˆå§‹åŒ–é’©å­
 */
public function moduleInit()
{
    // åœ¨æ¨¡å—åˆå§‹åŒ–æ—¶æ‰§è¡Œçš„ä»£ç 
}

/**
 * æ§åˆ¶å™¨å¼€å§‹é’©å­
 */
public function actionBegin()
{
    // åœ¨æ§åˆ¶å™¨å¼€å§‹æ—¶æ‰§è¡Œçš„ä»£ç 
}

/**
 * è§†å›¾è¿‡æ»¤é’©å­
 */
public function viewFilter(&$content)
{
    // è¿‡æ»¤è§†å›¾å†…å®¹
    $content = str_replace('åŸå†…å®¹', 'æ–°å†…å®¹', $content);
}

/**
 * åº”ç”¨ç»“æŸé’©å­
 */
public function appEnd()
{
    // åœ¨åº”ç”¨ç»“æŸæ—¶æ‰§è¡Œçš„ä»£ç 
}

/**
 * æ—¥å¿—å†™å…¥é’©å­
 */
public function logWrite($log)
{
    // å¤„ç†æ—¥å¿—å†™å…¥
}

/**
 * å“åº”å‘é€é’©å­
 */
public function responseSend($response)
{
    // å¤„ç†å“åº”å‘é€
}

/**
 * è‡ªå®šä¹‰é’©å­æ–¹æ³•
 */
public function customHook($params = [])
{
    // è‡ªå®šä¹‰é’©å­å¤„ç†é€»è¾‘
    return $params;
}
```

---

## ğŸ›ï¸ æ§åˆ¶å™¨å¼€å‘è§„èŒƒ

### å‰å°æ§åˆ¶å™¨
```php
<?php
namespace addons\example\controller;

use think\addons\Controller;

/**
 * ç¤ºä¾‹æ’ä»¶å‰å°æ§åˆ¶å™¨
 */
class Index extends Controller
{
    protected $layout = 'default';
    protected $config = [];

    public function _initialize()
    {
        parent::_initialize();
        $this->config = get_addon_config('example');
        $this->view->assign('config', $this->config);
    }

    /**
     * é¦–é¡µ
     */
    public function index()
    {
        $this->view->assign('title', 'ç¤ºä¾‹æ’ä»¶é¦–é¡µ');
        return $this->view->fetch();
    }

    /**
     * è¯¦æƒ…é¡µ
     */
    public function detail()
    {
        $id = $this->request->param('id', 0, 'intval');
        if (!$id) {
            $this->error('å‚æ•°é”™è¯¯');
        }

        $info = \addons\example\model\Example::get($id);
        if (!$info) {
            $this->error('è®°å½•ä¸å­˜åœ¨');
        }

        $this->view->assign('info', $info);
        return $this->view->fetch();
    }

    /**
     * AJAXæ¥å£
     */
    public function ajax()
    {
        if ($this->request->isAjax()) {
            $data = $this->request->post();
            
            // å¤„ç†ä¸šåŠ¡é€»è¾‘
            $result = $this->processData($data);
            
            if ($result) {
                $this->success('æ“ä½œæˆåŠŸ', $result);
            } else {
                $this->error('æ“ä½œå¤±è´¥');
            }
        }
        $this->error('éæ³•è¯·æ±‚');
    }

    /**
     * å¤„ç†æ•°æ®
     */
    private function processData($data)
    {
        // æ•°æ®å¤„ç†é€»è¾‘
        return true;
    }
}
```

### åå°æ§åˆ¶å™¨
```php
<?php
namespace addons\example\controller;

use app\common\controller\Backend;

/**
 * ç¤ºä¾‹æ’ä»¶åå°æ§åˆ¶å™¨
 */
class Admin extends Backend
{
    protected $model = null;
    protected $searchFields = 'id,title,content';
    protected $relationSearch = true;

    public function _initialize()
    {
        parent::_initialize();
        $this->model = new \addons\example\model\Example;
        
        $this->view->assign("statusList", $this->model->getStatusList());
    }

    /**
     * æŸ¥çœ‹åˆ—è¡¨
     */
    public function index()
    {
        $this->relationSearch = true;
        $this->request->filter(['strip_tags', 'trim']);
        
        if ($this->request->isAjax()) {
            if ($this->request->request('keyField')) {
                return $this->selectpage();
            }
            
            list($where, $sort, $order, $offset, $limit) = $this->buildparams();
            
            $list = $this->model
                    ->where($where)
                    ->order($sort, $order)
                    ->paginate($limit);

            $result = array("total" => $list->total(), "rows" => $list->items());
            return json($result);
        }
        return $this->view->fetch();
    }

    /**
     * æ·»åŠ 
     */
    public function add()
    {
        if ($this->request->isPost()) {
            $params = $this->request->post("row/a");
            if ($params) {
                $params = $this->preExcludeFields($params);
                
                if ($this->dataLimit && $this->dataLimitFieldAutoFill) {
                    $params[$this->dataLimitField] = $this->auth->id;
                }
                
                $result = false;
                \think\Db::startTrans();
                try {
                    if ($this->modelValidate) {
                        $name = str_replace("\\model\\", "\\validate\\", get_class($this->model));
                        $validate = is_bool($this->modelValidate) ? ($this->modelSceneValidate ? $name . '.add' : $name) : $this->modelValidate;
                        $this->model->validateFailException(true)->validate($validate);
                    }
                    $result = $this->model->allowField(true)->save($params);
                    \think\Db::commit();
                } catch (\think\exception\ValidateException $e) {
                    \think\Db::rollback();
                    $this->error($e->getMessage());
                } catch (\think\Exception $e) {
                    \think\Db::rollback();
                    $this->error($e->getMessage());
                }
                
                if ($result !== false) {
                    $this->success();
                } else {
                    $this->error(__('No rows were inserted'));
                }
            }
            $this->error(__('Parameter %s can not be empty', ''));
        }
        return $this->view->fetch();
    }

    /**
     * ç¼–è¾‘
     */
    public function edit($ids = null)
    {
        $row = $this->model->get($ids);
        if (!$row) {
            $this->error(__('No Results were found'));
        }
        
        $adminIds = $this->getDataLimitAdminIds();
        if (is_array($adminIds) && !in_array($row[$this->dataLimitField], $adminIds)) {
            $this->error(__('You have no permission'));
        }
        
        if ($this->request->isPost()) {
            $params = $this->request->post("row/a");
            if ($params) {
                $params = $this->preExcludeFields($params);
                $result = false;
                \think\Db::startTrans();
                try {
                    if ($this->modelValidate) {
                        $name = str_replace("\\model\\", "\\validate\\", get_class($this->model));
                        $validate = is_bool($this->modelValidate) ? ($this->modelSceneValidate ? $name . '.edit' : $name) : $this->modelValidate;
                        $row->validateFailException(true)->validate($validate);
                    }
                    $result = $row->allowField(true)->save($params);
                    \think\Db::commit();
                } catch (\think\exception\ValidateException $e) {
                    \think\Db::rollback();
                    $this->error($e->getMessage());
                } catch (\think\Exception $e) {
                    \think\Db::rollback();
                    $this->error($e->getMessage());
                }
                if ($result !== false) {
                    $this->success();
                } else {
                    $this->error(__('No rows were updated'));
                }
            }
            $this->error(__('Parameter %s can not be empty', ''));
        }
        $this->view->assign("row", $row);
        return $this->view->fetch();
    }

    /**
     * åˆ é™¤
     */
    public function del($ids = "")
    {
        if (!$this->request->isPost()) {
            $this->error(__("Invalid parameters"));
        }
        $ids = $ids ? $ids : $this->request->post("ids");
        if (!$ids) {
            $this->error(__('Parameter %s can not be empty', 'ids'));
        }
        $pk = $this->model->getPk();
        $adminIds = $this->getDataLimitAdminIds();
        if (is_array($adminIds)) {
            $this->model->where($this->dataLimitField, 'in', $adminIds);
        }
        $list = $this->model->where($pk, 'in', $ids)->select();

        $count = 0;
        \think\Db::startTrans();
        try {
            foreach ($list as $k => $v) {
                $count += $v->delete();
            }
            \think\Db::commit();
        } catch (\think\Exception $e) {
            \think\Db::rollback();
            $this->error($e->getMessage());
        }
        if ($count) {
            $this->success();
        } else {
            $this->error(__('No rows were deleted'));
        }
    }
}
```

---

## ğŸ—ƒï¸ æ¨¡å‹å¼€å‘è§„èŒƒ

### æ’ä»¶æ¨¡å‹
```php
<?php
namespace addons\example\model;

use think\Model;

/**
 * ç¤ºä¾‹æ¨¡å‹
 */
class Example extends Model
{
    // æ•°æ®è¡¨åç¼€ï¼ˆä¸å«è¡¨å‰ç¼€ï¼‰
    protected $name = 'example';
    
    // è‡ªåŠ¨å†™å…¥æ—¶é—´æˆ³å­—æ®µ
    protected $autoWriteTimestamp = 'int';

    // å®šä¹‰æ—¶é—´æˆ³å­—æ®µå
    protected $createTime = 'createtime';
    protected $updateTime = 'updatetime';
    protected $deleteTime = false;

    // è¿½åŠ å±æ€§
    protected $append = [
        'status_text'
    ];

    /**
     * è·å–çŠ¶æ€åˆ—è¡¨
     */
    public function getStatusList()
    {
        return [
            'normal' => __('Normal'),
            'hidden' => __('Hidden')
        ];
    }

    /**
     * è·å–çŠ¶æ€æ–‡æœ¬
     */
    public function getStatusTextAttr($value, $data)
    {
        $value = $value ? $value : (isset($data['status']) ? $data['status'] : '');
        $list = $this->getStatusList();
        return isset($list[$value]) ? $list[$value] : '';
    }

    /**
     * å…³è”ç”¨æˆ·è¡¨
     */
    public function user()
    {
        return $this->belongsTo('app\\common\\model\\User', 'user_id', 'id', [], 'LEFT')->setEagerlyType(0);
    }

    /**
     * å…³è”åˆ†ç±»è¡¨
     */
    public function category()
    {
        return $this->belongsTo('addons\\example\\model\\Category', 'category_id', 'id', [], 'LEFT')->setEagerlyType(0);
    }
}
```

### æ•°æ®éªŒè¯å™¨
```php
<?php
namespace addons\example\validate;

use think\Validate;

/**
 * ç¤ºä¾‹éªŒè¯å™¨
 */
class Example extends Validate
{
    /**
     * éªŒè¯è§„åˆ™
     */
    protected $rule = [
        'title'       => 'require|length:2,100',
        'content'     => 'require',
        'category_id' => 'require|integer|gt:0',
        'status'      => 'require|in:normal,hidden',
        'weigh'       => 'integer',
    ];

    /**
     * æç¤ºæ¶ˆæ¯
     */
    protected $message = [
        'title.require'       => 'æ ‡é¢˜ä¸èƒ½ä¸ºç©º',
        'title.length'        => 'æ ‡é¢˜é•¿åº¦å¿…é¡»åœ¨2-100ä¸ªå­—ç¬¦ä¹‹é—´',
        'content.require'     => 'å†…å®¹ä¸èƒ½ä¸ºç©º',
        'category_id.require' => 'åˆ†ç±»ä¸èƒ½ä¸ºç©º',
        'category_id.integer' => 'åˆ†ç±»IDå¿…é¡»æ˜¯æ•´æ•°',
        'category_id.gt'      => 'åˆ†ç±»IDå¿…é¡»å¤§äº0',
        'status.require'      => 'çŠ¶æ€ä¸èƒ½ä¸ºç©º',
        'status.in'           => 'çŠ¶æ€å€¼ä¸æ­£ç¡®',
        'weigh.integer'       => 'æ’åºå€¼å¿…é¡»æ˜¯æ•´æ•°',
    ];

    /**
     * éªŒè¯åœºæ™¯
     */
    protected $scene = [
        'add'  => ['title', 'content', 'category_id', 'status', 'weigh'],
        'edit' => ['title', 'content', 'category_id', 'status', 'weigh'],
    ];
}
```

---

## ğŸ¨ è§†å›¾å¼€å‘è§„èŒƒ

### å‰å°è§†å›¾æ¨¡æ¿
```html
<!-- view/index/index.html -->
{extend name="addon_layout"}

{block name="content"}
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <h1>{$title}</h1>
            <div class="example-content">
                <p>è¿™æ˜¯ç¤ºä¾‹æ’ä»¶çš„å‰å°é¡µé¢</p>
                <div class="example-list">
                    {volist name="list" id="item"}
                    <div class="example-item">
                        <h3><a href="{:addon_url('example/index/detail', ['id' => $item.id])}">{$item.title}</a></h3>
                        <p>{$item.intro}</p>
                        <span class="text-muted">{$item.createtime|date='Y-m-d H:i:s'}</span>
                    </div>
                    {/volist}
                </div>
                
                <!-- åˆ†é¡µ -->
                <div class="pagination-wrapper">
                    {$list->render()}
                </div>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="script"}
<script>
$(function() {
    // å‰å°JavaScriptä»£ç 
    $('.example-item').on('click', function() {
        // å¤„ç†ç‚¹å‡»äº‹ä»¶
    });
});
</script>
{/block}
```

### åå°è§†å›¾æ¨¡æ¿
```html
<!-- view/admin/index.html -->
{extend name="layout/default" /}

{block name="content"}
<div class="panel panel-default panel-intro">
    <div class="panel-heading">
        {:build_heading()}
    </div>
    <div class="panel-body">
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade active in" id="one">
                <div class="widget-body no-padding">
                    <div id="toolbar" class="toolbar">
                        <a href="javascript:;" class="btn btn-primary btn-refresh" title="{:__('Refresh')}" ><i class="fa fa-refresh"></i> </a>
                        <a href="javascript:;" class="btn btn-success btn-add" title="{:__('Add')}" ><i class="fa fa-plus"></i> {:__('Add')}</a>
                        <a href="javascript:;" class="btn btn-success btn-edit btn-disabled disabled" title="{:__('Edit')}" ><i class="fa fa-pencil"></i> {:__('Edit')}</a>
                        <a href="javascript:;" class="btn btn-danger btn-del btn-disabled disabled" title="{:__('Delete')}" ><i class="fa fa-trash"></i> {:__('Delete')}</a>
                    </div>
                    <table id="table" class="table table-striped table-bordered table-hover" width="100%">
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="js"}
<script src="{:cdnurl('assets/js/backend/example.js', true)}"></script>
{/block}
```

---

## ğŸ¯ JavaScriptå¼€å‘è§„èŒƒ

### å‰å°JavaScript
```javascript
// public/assets/js/frontend.js
define(['jquery'], function ($) {
    
    var Example = {
        init: function() {
            this.bindEvents();
        },
        
        bindEvents: function() {
            // ç»‘å®šäº‹ä»¶
            $(document).on('click', '.btn-action', function() {
                Example.handleAction($(this));
            });
            
            // AJAXæäº¤è¡¨å•
            $(document).on('submit', '.example-form', function(e) {
                e.preventDefault();
                Example.submitForm($(this));
            });
        },
        
        handleAction: function($btn) {
            var action = $btn.data('action');
            var id = $btn.data('id');
            
            $.ajax({
                url: Config.addon_url + '/ajax',
                type: 'POST',
                data: {
                    action: action,
                    id: id
                },
                dataType: 'json',
                success: function(response) {
                    if (response.code === 1) {
                        Toastr.success(response.msg);
                        // åˆ·æ–°é¡µé¢æˆ–æ›´æ–°å†…å®¹
                        location.reload();
                    } else {
                        Toastr.error(response.msg);
                    }
                },
                error: function() {
                    Toastr.error('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
                }
            });
        },
        
        submitForm: function($form) {
            var formData = $form.serialize();
            
            $.ajax({
                url: $form.attr('action'),
                type: 'POST',
                data: formData,
                dataType: 'json',
                success: function(response) {
                    if (response.code === 1) {
                        Toastr.success(response.msg);
                        // é‡ç½®è¡¨å•
                        $form[0].reset();
                    } else {
                        Toastr.error(response.msg);
                    }
                },
                error: function() {
                    Toastr.error('æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•');
                }
            });
        }
    };
    
    // åˆå§‹åŒ–
    $(document).ready(function() {
        Example.init();
    });
    
    return Example;
});
```

### åå°JavaScript
```javascript
// public/assets/js/backend.js
define(['jquery', 'bootstrap', 'backend', 'table', 'form'], function ($, undefined, Backend, Table, Form) {

    var Controller = {
        index: function () {
            // åˆå§‹åŒ–è¡¨æ ¼å‚æ•°é…ç½®
            Table.api.init({
                extend: {
                    index_url: Config.addon_url + '/admin/index' + location.search,
                    add_url: Config.addon_url + '/admin/add',
                    edit_url: Config.addon_url + '/admin/edit',
                    del_url: Config.addon_url + '/admin/del',
                    multi_url: Config.addon_url + '/admin/multi',
                    table: 'example',
                }
            });

            var table = $("#table");

            // åˆå§‹åŒ–è¡¨æ ¼
            table.bootstrapTable({
                url: $.fn.bootstrapTable.defaults.extend.index_url,
                pk: 'id',
                sortName: 'id',
                columns: [
                    [
                        {checkbox: true},
                        {field: 'id', title: __('Id')},
                        {field: 'title', title: __('Title'), operate: 'LIKE'},
                        {field: 'content', title: __('Content'), operate: 'LIKE'},
                        {field: 'category.name', title: __('Category'), operate: false},
                        {field: 'status', title: __('Status'), searchList: {"normal":__('Normal'),"hidden":__('Hidden')}, formatter: Table.api.formatter.status},
                        {field: 'weigh', title: __('Weigh')},
                        {field: 'createtime', title: __('Createtime'), operate:'RANGE', addclass:'datetimerange', formatter: Table.api.formatter.datetime},
                        {field: 'operate', title: __('Operate'), table: table, events: Table.api.events.operate, formatter: Table.api.formatter.operate}
                    ]
                ]
            });

            // ä¸ºè¡¨æ ¼ç»‘å®šäº‹ä»¶
            Table.api.bindevent(table);
        },
        
        add: function () {
            Controller.api.bindevent();
        },
        
        edit: function () {
            Controller.api.bindevent();
        },
        
        api: {
            bindevent: function () {
                Form.api.bindevent($("form[role=form]"));
                
                // è‡ªå®šä¹‰äº‹ä»¶ç»‘å®š
                $(document).on('click', '.btn-custom', function() {
                    var id = $(this).data('id');
                    Controller.api.customAction(id);
                });
            },
            
            customAction: function(id) {
                Layer.confirm(__('Are you sure?'), function(index) {
                    Backend.api.ajax({
                        url: Config.addon_url + '/admin/custom',
                        data: {id: id}
                    }, function(data, ret) {
                        Layer.close(index);
                        Toastr.success(__('Operation completed'));
                        $("#table").bootstrapTable('refresh');
                    });
                });
            }
        }
    };
    
    return Controller;
});
```

---

## ğŸ”§ é…ç½®æ–‡ä»¶è§„èŒƒ

### æ’ä»¶é…ç½®æ–‡ä»¶
```php
<?php
// config/config.php
return [
    // åŸºç¡€é…ç½®
    'name' => [
        'title' => 'æ’ä»¶åç§°',
        'type' => 'string',
        'value' => 'ç¤ºä¾‹æ’ä»¶',
        'rule' => 'required',
        'msg' => 'æ’ä»¶åç§°ä¸èƒ½ä¸ºç©º',
        'tip' => 'è¯·è¾“å…¥æ’ä»¶åç§°',
        'ok' => '',
        'extend' => ''
    ],
    
    // å¼€å…³é…ç½®
    'enable' => [
        'title' => 'æ˜¯å¦å¯ç”¨',
        'type' => 'radio',
        'value' => '1',
        'options' => [
            '1' => 'å¯ç”¨',
            '0' => 'ç¦ç”¨'
        ],
        'rule' => 'required',
        'msg' => 'è¯·é€‰æ‹©æ˜¯å¦å¯ç”¨',
        'tip' => 'é€‰æ‹©æ˜¯å¦å¯ç”¨è¯¥åŠŸèƒ½',
        'ok' => '',
        'extend' => ''
    ],
    
    // é€‰æ‹©é…ç½®
    'template' => [
        'title' => 'æ¨¡æ¿é€‰æ‹©',
        'type' => 'select',
        'value' => 'default',
        'options' => [
            'default' => 'é»˜è®¤æ¨¡æ¿',
            'simple' => 'ç®€å•æ¨¡æ¿',
            'advanced' => 'é«˜çº§æ¨¡æ¿'
        ],
        'rule' => 'required',
        'msg' => 'è¯·é€‰æ‹©æ¨¡æ¿',
        'tip' => 'é€‰æ‹©æ˜¾ç¤ºæ¨¡æ¿',
        'ok' => '',
        'extend' => ''
    ],
    
    // æ•°å€¼é…ç½®
    'pagesize' => [
        'title' => 'æ¯é¡µæ˜¾ç¤ºæ•°é‡',
        'type' => 'number',
        'value' => '10',
        'rule' => 'required|integer|between:1,100',
        'msg' => 'æ¯é¡µæ˜¾ç¤ºæ•°é‡å¿…é¡»æ˜¯1-100ä¹‹é—´çš„æ•´æ•°',
        'tip' => 'è®¾ç½®æ¯é¡µæ˜¾ç¤ºçš„è®°å½•æ•°é‡',
        'ok' => '',
        'extend' => ''
    ],
    
    // æ–‡æœ¬åŸŸé…ç½®
    'description' => [
        'title' => 'æ’ä»¶æè¿°',
        'type' => 'textarea',
        'value' => 'è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ’ä»¶',
        'rule' => '',
        'msg' => '',
        'tip' => 'è¯·è¾“å…¥æ’ä»¶æè¿°',
        'ok' => '',
        'extend' => ''
    ],
    
    // å¯Œæ–‡æœ¬é…ç½®
    'content' => [
        'title' => 'æ’ä»¶å†…å®¹',
        'type' => 'editor',
        'value' => '<p>æ’ä»¶å†…å®¹</p>',
        'rule' => '',
        'msg' => '',
        'tip' => 'è¯·è¾“å…¥æ’ä»¶å†…å®¹',
        'ok' => '',
        'extend' => ''
    ],
    
    // å›¾ç‰‡é…ç½®
    'logo' => [
        'title' => 'æ’ä»¶Logo',
        'type' => 'image',
        'value' => '/assets/img/logo.png',
        'rule' => '',
        'msg' => '',
        'tip' => 'è¯·ä¸Šä¼ æ’ä»¶Logo',
        'ok' => '',
        'extend' => ''
    ],
    
    // æ–‡ä»¶é…ç½®
    'file' => [
        'title' => 'é…ç½®æ–‡ä»¶',
        'type' => 'file',
        'value' => '',
        'rule' => '',
        'msg' => '',
        'tip' => 'è¯·ä¸Šä¼ é…ç½®æ–‡ä»¶',
        'ok' => '',
        'extend' => ''
    ]
];
```

---

## ğŸ“Š æ•°æ®åº“æ“ä½œè§„èŒƒ

### å®‰è£…SQLæ–‡ä»¶
```sql
-- install.sql
CREATE TABLE IF NOT EXISTS `__PREFIX__example` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `category_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT 'åˆ†ç±»ID',
  `user_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT 'ç”¨æˆ·ID',
  `title` varchar(100) NOT NULL DEFAULT '' COMMENT 'æ ‡é¢˜',
  `content` text COMMENT 'å†…å®¹',
  `image` varchar(255) NOT NULL DEFAULT '' COMMENT 'å›¾ç‰‡',
  `views` int(10) unsigned NOT NULL DEFAULT '0' COMMENT 'æµè§ˆæ¬¡æ•°',
  `weigh` int(10) NOT NULL DEFAULT '0' COMMENT 'æƒé‡',
  `status` enum('normal','hidden') NOT NULL DEFAULT 'normal' COMMENT 'çŠ¶æ€',
  `createtime` int(10) unsigned DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `updatetime` int(10) unsigned DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `category_id` (`category_id`),
  KEY `user_id` (`user_id`),
  KEY `status` (`status`),
  KEY `weigh` (`weigh`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç¤ºä¾‹è¡¨';

-- æ’å…¥ç¤ºä¾‹æ•°æ®
INSERT INTO `__PREFIX__example` (`id`, `category_id`, `user_id`, `title`, `content`, `image`, `views`, `weigh`, `status`, `createtime`, `updatetime`) VALUES
(1, 1, 1, 'ç¤ºä¾‹æ ‡é¢˜1', 'ç¤ºä¾‹å†…å®¹1', '', 0, 1, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(2, 1, 1, 'ç¤ºä¾‹æ ‡é¢˜2', 'ç¤ºä¾‹å†…å®¹2', '', 0, 2, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());

-- åˆ›å»ºåˆ†ç±»è¡¨
CREATE TABLE IF NOT EXISTS `__PREFIX__example_category` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `pid` int(10) unsigned NOT NULL DEFAULT '0' COMMENT 'çˆ¶ID',
  `name` varchar(50) NOT NULL DEFAULT '' COMMENT 'åˆ†ç±»åç§°',
  `image` varchar(255) NOT NULL DEFAULT '' COMMENT 'å›¾ç‰‡',
  `weigh` int(10) NOT NULL DEFAULT '0' COMMENT 'æƒé‡',
  `status` enum('normal','hidden') NOT NULL DEFAULT 'normal' COMMENT 'çŠ¶æ€',
  `createtime` int(10) unsigned DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´',
  `updatetime` int(10) unsigned DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `pid` (`pid`),
  KEY `status` (`status`),
  KEY `weigh` (`weigh`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç¤ºä¾‹åˆ†ç±»è¡¨';

-- æ’å…¥åˆ†ç±»æ•°æ®
INSERT INTO `__PREFIX__example_category` (`id`, `pid`, `name`, `image`, `weigh`, `status`, `createtime`, `updatetime`) VALUES
(1, 0, 'é»˜è®¤åˆ†ç±»', '', 1, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

### å¸è½½SQLæ–‡ä»¶
```sql
-- uninstall.sql
DROP TABLE IF EXISTS `__PREFIX__example`;
DROP TABLE IF EXISTS `__PREFIX__example_category`;
```

---

## ğŸŒ è¯­è¨€åŒ…è§„èŒƒ

### ä¸­æ–‡è¯­è¨€åŒ…
```php
<?php
// lang/zh-cn.php
return [
    // åŸºç¡€è¯æ±‡
    'Example'         => 'ç¤ºä¾‹',
    'Title'           => 'æ ‡é¢˜',
    'Content'         => 'å†…å®¹',
    'Category'        => 'åˆ†ç±»',
    'Image'           => 'å›¾ç‰‡',
    'Views'           => 'æµè§ˆæ¬¡æ•°',
    'Weigh'           => 'æƒé‡',
    'Status'          => 'çŠ¶æ€',
    'Normal'          => 'æ­£å¸¸',
    'Hidden'          => 'éšè—',
    'Createtime'      => 'åˆ›å»ºæ—¶é—´',
    'Updatetime'      => 'æ›´æ–°æ—¶é—´',
    
    // æ“ä½œè¯æ±‡
    'Add'             => 'æ·»åŠ ',
    'Edit'            => 'ç¼–è¾‘',
    'Delete'          => 'åˆ é™¤',
    'View'            => 'æŸ¥çœ‹',
    'Search'          => 'æœç´¢',
    'Reset'           => 'é‡ç½®',
    'Submit'          => 'æäº¤',
    'Cancel'          => 'å–æ¶ˆ',
    'Confirm'         => 'ç¡®è®¤',
    'Save'            => 'ä¿å­˜',
    
    // æç¤ºä¿¡æ¯
    'Operation successful'     => 'æ“ä½œæˆåŠŸ',
    'Operation failed'         => 'æ“ä½œå¤±è´¥',
    'Are you sure?'           => 'æ‚¨ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ',
    'No data available'       => 'æš‚æ— æ•°æ®',
    'Please select at least one record' => 'è¯·è‡³å°‘é€‰æ‹©ä¸€æ¡è®°å½•',
    'Invalid parameters'      => 'å‚æ•°é”™è¯¯',
    'Access denied'           => 'è®¿é—®è¢«æ‹’ç»',
    
    // éªŒè¯ä¿¡æ¯
    'Title cannot be empty'   => 'æ ‡é¢˜ä¸èƒ½ä¸ºç©º',
    'Content cannot be empty' => 'å†…å®¹ä¸èƒ½ä¸ºç©º',
    'Category cannot be empty' => 'åˆ†ç±»ä¸èƒ½ä¸ºç©º',
    'Invalid image format'    => 'å›¾ç‰‡æ ¼å¼ä¸æ­£ç¡®',
    'Image size too large'    => 'å›¾ç‰‡å°ºå¯¸è¿‡å¤§',
    
    // æ’ä»¶ä¸“ç”¨
    'Plugin configuration'    => 'æ’ä»¶é…ç½®',
    'Plugin management'       => 'æ’ä»¶ç®¡ç†',
    'Plugin settings'         => 'æ’ä»¶è®¾ç½®',
];
```

---

## ğŸ” å®‰å…¨è§„èŒƒ

### æƒé™æ§åˆ¶
```php
/**
 * æ£€æŸ¥æƒé™
 */
public function checkAuth($action = '')
{
    $auth = $this->auth;
    if (!$auth->isLogin()) {
        $this->error('è¯·å…ˆç™»å½•', null, ['url' => '/admin/login']);
    }
    
    $controller = request()->controller();
    $action = $action ?: request()->action();
    $rule = strtolower($controller . '/' . $action);
    
    if (!$auth->check($rule)) {
        $this->error('æ‚¨æ²¡æœ‰æƒé™è®¿é—®');
    }
}

/**
 * æ•°æ®æƒé™é™åˆ¶
 */
public function dataLimit($model, $field = 'user_id')
{
    $auth = $this->auth;
    if ($auth->isSuperAdmin()) {
        return $model;
    }
    
    // åªèƒ½æŸ¥çœ‹è‡ªå·±çš„æ•°æ®
    return $model->where($field, $auth->id);
}
```

### è¾“å…¥éªŒè¯
```php
/**
 * éªŒè¯è¾“å…¥æ•°æ®
 */
public function validateInput($data, $rules = [])
{
    $validate = new \think\Validate($rules);
    
    if (!$validate->check($data)) {
        $this->error($validate->getError());
    }
    
    // è¿‡æ»¤å±é™©å­—ç¬¦
    foreach ($data as $key => $value) {
        if (is_string($value)) {
            $data[$key] = htmlspecialchars(strip_tags($value));
        }
    }
    
    return $data;
}

/**
 * é˜²æ­¢SQLæ³¨å…¥
 */
public function safeSql($sql, $params = [])
{
    // ä½¿ç”¨å‚æ•°ç»‘å®š
    return \think\Db::query($sql, $params);
}

/**
 * é˜²æ­¢XSSæ”»å‡»
 */
public function filterXss($content)
{
    // è¿‡æ»¤å±é™©æ ‡ç­¾å’Œå±æ€§
    $content = preg_replace('/<script[^>]*?>.*?<\/script>/si', '', $content);
    $content = preg_replace('/<iframe[^>]*?>.*?<\/iframe>/si', '', $content);
    $content = preg_replace('/on\w+\s*=\s*["\'][^"\']*["\']/i', '', $content);
    
    return $content;
}
```

---

## ğŸ“‹ ä»£ç è´¨é‡æ£€æŸ¥

### æ’ä»¶å¼€å‘æ£€æŸ¥æ¸…å•
- [ ] æ’ä»¶ç›®å½•ç»“æ„æ­£ç¡®
- [ ] info.inié…ç½®å®Œæ•´
- [ ] æ’ä»¶ä¸»ç±»ç»§æ‰¿Addons
- [ ] å®‰è£…/å¸è½½æ–¹æ³•å®ç°
- [ ] æ§åˆ¶å™¨ç»§æ‰¿æ­£ç¡®åŸºç±»
- [ ] æ¨¡å‹å®šä¹‰è§„èŒƒ
- [ ] è§†å›¾æ¨¡æ¿ç»“æ„å®Œæ•´
- [ ] JavaScriptæ¨¡å—åŒ–å¼€å‘
- [ ] è¯­è¨€åŒ…ç¿»è¯‘å®Œæ•´
- [ ] æ•°æ®åº“SQLæ–‡ä»¶æ­£ç¡®
- [ ] æƒé™æ§åˆ¶å®ç°
- [ ] è¾“å…¥éªŒè¯å®Œå–„
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶
- [ ] æ€§èƒ½ä¼˜åŒ–è€ƒè™‘

### åŠŸèƒ½æµ‹è¯•è¦ç‚¹
- [ ] æ’ä»¶å®‰è£…åŠŸèƒ½æ­£å¸¸
- [ ] æ’ä»¶å¸è½½åŠŸèƒ½æ­£å¸¸
- [ ] æ’ä»¶å¯ç”¨/ç¦ç”¨æ­£å¸¸
- [ ] å‰å°é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] åå°ç®¡ç†åŠŸèƒ½æ­£å¸¸
- [ ] æ•°æ®å¢åˆ æ”¹æŸ¥æ­£å¸¸
- [ ] æƒé™æ§åˆ¶ç”Ÿæ•ˆ
- [ ] é…ç½®åŠŸèƒ½æ­£å¸¸
- [ ] å¤šè¯­è¨€æ”¯æŒæ­£å¸¸
- [ ] å“åº”å¼å¸ƒå±€æ­£å¸¸

### å…¼å®¹æ€§æ£€æŸ¥
- [ ] PHPç‰ˆæœ¬å…¼å®¹æ€§
- [ ] ThinkPHPç‰ˆæœ¬å…¼å®¹æ€§
- [ ] FastAdminç‰ˆæœ¬å…¼å®¹æ€§
- [ ] æ•°æ®åº“å…¼å®¹æ€§
- [ ] æµè§ˆå™¨å…¼å®¹æ€§
- [ ] ç§»åŠ¨ç«¯å…¼å®¹æ€§
- [ ] æ’ä»¶é—´å…¼å®¹æ€§
- [ ] ä¸»é¢˜å…¼å®¹æ€§

---

**æ³¨æ„**: æ’ä»¶å¼€å‘åº”éµå¾ªFastAdminçš„å¼€å‘è§„èŒƒï¼Œç¡®ä¿æ’ä»¶çš„ç¨³å®šæ€§ã€å®‰å…¨æ€§å’Œå…¼å®¹æ€§ã€‚å¼€å‘å®Œæˆååº”è¿›è¡Œå……åˆ†æµ‹è¯•ã€‚